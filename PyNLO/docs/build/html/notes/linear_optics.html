
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Linear Optics &#8212; PyNLO 1.dev documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notes/linear_optics';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Nonlinear Optics" href="nonlinear_optics.html" />
    <link rel="prev" title="Fourier Transforms" href="fourier_transforms.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/pynlo-light.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/pynlo-dark.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../guides.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../notes.html">
                        Notes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../guides.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../notes.html">
                        Notes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../api.html">
                        API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="fourier_transforms.html">Fourier Transforms</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Linear Optics</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_optics.html">Nonlinear Optics</a></li>
<li class="toctree-l1"><a class="reference internal" href="supplemental.html">Supplementary Material</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../notes.html" class="nav-link">Notes</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Linear Optics</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="Linear-Optics">
<h1>Linear Optics<a class="headerlink" href="#Linear-Optics" title="Permalink to this heading">#</a></h1>
<section id="Maxwell's-Equations">
<h2>Maxwell’s Equations<a class="headerlink" href="#Maxwell's-Equations" title="Permalink to this heading">#</a></h2>
<p>Maxwell’s equations fully describe the dynamical evolution of classical electromagnetic fields. In the time-space domain <span class="math notranslate nohighlight">\(\left(t, \mathbf{x}\right)\)</span>, the equations are as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\rho_{f} &amp;= \nabla \cdot \mathbf{D} \tag{1a}
\\
0 &amp;= \nabla \cdot \mathbf{B} \tag{1b}
\\
\mathbf{0} &amp;= \nabla \times \mathbf{E} + \frac{\partial}{\partial t} \mathbf{B} \tag{1c}
\\
\mathbf{J}_{f} &amp;= \nabla \times \mathbf{H} - \frac{\partial}{\partial t} \mathbf{D} \tag{1d}
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_f\)</span> is the free charge density and <span class="math notranslate nohighlight">\(\mathbf{J}_f\)</span> is the free current density.</p>
<p>The auxiliary fields <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{H}\)</span>, the electric displacement and magnetic field, are typically defined in terms of externally applied <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> fields and the electric <span class="math notranslate nohighlight">\(\left(\mathbf{P}\right)\)</span> and magnetic <span class="math notranslate nohighlight">\(\left(\mathbf{M}\right)\)</span> polarization, which are themselves functions of the <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> fields:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{D} &amp;= \epsilon_0 \mathbf{E} + \mathbf{P}\!\left[\mathbf{E}, \mathbf{B}\right]
\\
\mathbf{H} &amp;= \frac{1}{\mu_0} \mathbf{B} - \mathbf{M}\!\left[\mathbf{E}, \mathbf{B}\right]
\end{align}\end{split}\]</div>
<p>The electric permittivity <span class="math notranslate nohighlight">\(\epsilon_0\)</span> and the magnetic permeability <span class="math notranslate nohighlight">\(\mu_0\)</span> define the units of the two fields. Their product is equal to the reciprocal of the speed of light squared:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
\mu_{0} \, \epsilon_{0} = \frac{1}{c^{2}}
\end{gather}\]</div>
<section id="Electric-and-Magnetic-Polarization">
<h3>Electric and Magnetic Polarization<a class="headerlink" href="#Electric-and-Magnetic-Polarization" title="Permalink to this heading">#</a></h3>
<p>The magnetic response is negligible for common optical materials, so the electric polarization typically dominates light-matter interactions. Given as a power series, the electric polarization can be expanded in the time-space domain <span class="math notranslate nohighlight">\(\left(t, \mathbf{x}\right)\)</span> as tensor product convolutions of electric susceptibilities with the electric field:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
P_{i} &amp;= \epsilon_0 \left( \chi^{(1)}_{ij} * E_{j} + \chi^{(2)}_{ijk} ** E_{j}E_{k} + \chi^{(3)}_{ijkl} *** E_{j}E_{k}E_{l} + \ldots \right)
\\
M_{i} &amp;\approx 0
\end{align}\end{split}\]</div>
<p>where the “<span class="math notranslate nohighlight">\(*\)</span>” indicate convolutions, i.e.:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\left(\chi^{(1)}_{ij} * E_{j}\right)\!\left[t\right] &amp;= \int_{-\infty}^{\infty} \chi^{(1)}_{ij}\!\left[\tau_1\right] E_{j}\!\left[t-\tau_1\right] d\tau_1
\\
\left(\chi^{(2)}_{ijk} ** E_{j}E_{k}\right)\!\left[t\right] &amp;= \iint_{-\infty}^{\infty} \chi^{(2)}_{ijk}\!\left[\tau_1, \tau_2\right] E_{j}\!\left[t-\tau_1\right] E_{k}\!\left[t-\tau_2\right] d\tau_1 \, d\tau_2
\\
\vdots &amp;
\end{align}\end{split}\]</div>
<p>Due to causality, the amplitude of the <span class="math notranslate nohighlight">\(\chi\)</span> terms must vanish at input times less than <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>By Fourier transforming to the frequency domain <span class="math notranslate nohighlight">\(\left(\omega, \mathbf{x}\right)\)</span>, the first term <span class="math notranslate nohighlight">\(\left(\chi^{\left(1\right)}\right)\)</span> collapses to a multiplication and the electric displacement and magnetic field can be rewritten in a form that separates the linear and nonlinear contributions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{D} &amp;= \epsilon_0 \left(\mathbf{\epsilon} \cdot \mathbf{E}\right) + \mathbf{P}_{NL}
\\
\mathbf{B} &amp;= \mu_0 \mathbf{H}
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{gather}
\epsilon = \mathbf{1} + \chi^{(1)}
\end{gather}\]</div>
<p>The linear susceptibility <span class="math notranslate nohighlight">\(\chi^{(1)}\)</span> has been absorbed into the relative permittivity term <span class="math notranslate nohighlight">\(\mathbf{\epsilon}\)</span>, while the higher-order terms have been condensed into the nonlinear polarization <span class="math notranslate nohighlight">\(\mathbf{P}_{NL}\)</span>. For more details on the nonlinear polarization see the note on <a class="reference internal" href="nonlinear_optics.html#Free-Sources-and-Nonlinearity"><span class="std std-ref">nonlinear optics</span></a>.</p>
</section>
<section id="Boundary-Conditions">
<h3>Boundary Conditions<a class="headerlink" href="#Boundary-Conditions" title="Permalink to this heading">#</a></h3>
<p>Boundary conditions are necessary at the interface between different materials. With <span class="math notranslate nohighlight">\(\hat{\mathbf{n}}\)</span> being the unit normal to a surface, the following boundary conditions are always true for the normal and tangential components (in the space domain):</p>
<section id="Normal-Components">
<h4>Normal Components<a class="headerlink" href="#Normal-Components" title="Permalink to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\sigma &amp;= \hat{\mathbf{n}} \cdot \left( \mathbf{D}_{2} - \mathbf{D}_{1} \right)
\\
0 &amp;= \hat{\mathbf{n}} \cdot \left( \mathbf{B}_{2} - \mathbf{B}_{1} \right)
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is the free charge density on the surface.</p>
</section>
<section id="Tangential-Components">
<h4>Tangential Components<a class="headerlink" href="#Tangential-Components" title="Permalink to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{K} &amp;= \hat{\mathbf{n}} \times \left( \mathbf{H}_{2} - \mathbf{H}_{1} \right)
\\
\mathbf{0} &amp;= \hat{\mathbf{n}} \times \left( \mathbf{E}_{2} - \mathbf{E}_{1} \right)
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is the free current density on the surface.</p>
</section>
</section>
</section>
<section id="Traveling-Waves">
<h2>Traveling Waves<a class="headerlink" href="#Traveling-Waves" title="Permalink to this heading">#</a></h2>
<p>A wave equation can be derived by taking the curl of 1c and 1d of Maxwell’s equations. Assuming that the medium is <em>linear, isotropic, homogenous, and without any free charges or currents</em>, this equation simplifies to the following in the doubly Fourier transformed frequency-wavenumber domain <span class="math notranslate nohighlight">\(\left(\omega, \mathbf{k}\right)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{0} &amp;= \left(\epsilon \frac{\omega^2}{c^2} - k^2\right) \mathbf{E}
\\
\mathbf{0} &amp;= \left(\epsilon \frac{\omega^2}{c^2} - k^2\right) \mathbf{H}
\end{align}\end{split}\]</div>
<p>These equations are satisfied when:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
k^2 = \epsilon \frac{\omega^2}{c^2}
\end{gather}\]</div>
<p>There are four possible solutions depending on the sign of <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(k\)</span>. Those solutions correspond to forward and backward traveling waves. By convention, we choose forward traveling waves as the solutions where <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(k\)</span> have the same sign, i.e. <span class="math notranslate nohighlight">\(\omega, k &gt; 0\)</span> or <span class="math notranslate nohighlight">\(\omega, k &lt; 0\)</span>, and backward traveling waves as solutions where <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(k\)</span> have opposite signs, i.e. <span class="math notranslate nohighlight">\(\omega &gt; 0\)</span> and <span class="math notranslate nohighlight">\(k &lt; 0\)</span> or <span class="math notranslate nohighlight">\(\omega &lt; 0\)</span> and
<span class="math notranslate nohighlight">\(k &gt; 0\)</span>.</p>
<p>Using this convention, traveling waves in the time-space domain <span class="math notranslate nohighlight">\(\left(t, \mathbf{x}\right)\)</span> take the following form:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
\mathbf{E}, \mathbf{H} \sim \mathbf{a} \, e^{i \left( \omega \, t - \mathbf{k} \cdot \mathbf{x}\right)} + \text{c.c.}
\end{gather}\]</div>
<p>where the vector <span class="math notranslate nohighlight">\(\mathbf{k}\)</span> points in the direction of propagation. These solutions are plane waves and have uniform amplitude and phase across an infinite 2D plane. The “<span class="math notranslate nohighlight">\(\text{c.c.}\)</span>” stands for complex conjugate and contains the negated <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(k\)</span> terms. In general, the value of <span class="math notranslate nohighlight">\(k\)</span> is both negated and conjugated at negative frequency, i.e. <span class="math notranslate nohighlight">\(k[-\omega] = -\overline{k}[\omega]\)</span>.</p>
<p>The vectoral relationship between the <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{H}\)</span> fields can be found by substituting these solutions into Maxwell’s equations. The electric and magnetic fields are orthogonal to the direction of propagation and to each other. In the time-space domain <span class="math notranslate nohighlight">\(\left(t, \mathbf{x}\right)\)</span>, the relationships are as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
0 = \mathbf{k} \cdot \left(\mathbf{E} \ \text{or} \ \mathbf{H}\right)
\end{gather}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{E} &amp;= \frac{1}{\epsilon_0 \ \epsilon} \frac{\mathbf{k}}{\omega} \times \mathbf{H}
\\
\mathbf{H} &amp;= \frac{1}{\mu_0} \frac{\mathbf{k}}{\omega} \times \mathbf{E}
\end{align}\end{split}\]</div>
<section id="A-Note-on-Fourier-Transforms-and-Units">
<h3>A Note on Fourier Transforms and Units<a class="headerlink" href="#A-Note-on-Fourier-Transforms-and-Units" title="Permalink to this heading">#</a></h3>
<p>Fourier transforms convert between complementary reciprocal quantities:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\left(t, \nu\right) &amp;: \text{time and frequency (reciprocal period)}
\\
\left(\mathbf{x}, \mathbf{\tilde{\nu}}\right) &amp;: \text{length and wavenumber (reciprocal wavelength)}
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
f\!\left[t\right] &amp;= \int_{-\infty}^{\infty} F\!\left[\nu\right] e^{+i \left(2 \ \pi \ \nu \ t\right)} d\nu
&amp;
F\!\left[\nu\right] &amp;= \int_{-\infty}^{\infty} f\!\left[t\right] e^{-i \left(2 \ \pi \ \nu \ t\right)} dt
\\
f\!\left[\mathbf{x}\right] &amp;= \int_{-\infty}^{\infty} F\!\left[\mathbf{\tilde{\nu}}\right] e^{-i \left(2 \ \pi \ \mathbf{\tilde{\nu}} \cdot \mathbf{x}\right)} d\tilde{\nu}^3
&amp;
F\!\left[\mathbf{\tilde{\nu}}\right] &amp;= \int_{-\infty}^{\infty} f\!\left[\mathbf{x}\right] e^{+i \left(2 \ \pi \ \mathbf{\tilde{\nu}} \cdot \mathbf{x}\right)} dx^3
\end{align}\end{split}\]</div>
<p>For convenience and clearer typesetting when both <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(\mathbf{\tilde{\nu}}\)</span> are in the same set of equations, factors of <span class="math notranslate nohighlight">\(2 \, \pi\)</span> are combined with the Fourier domain quantities. This is only a notational change:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\text{Angular Frequency} &amp;: \omega = 2 \pi \, \nu = 2 \pi / T \\
\text{Angular Wavenumber} &amp;: \mathbf{k} = 2 \pi \, \mathbf{\tilde{\nu}} = 2 \pi / \lambda
\end{align}\end{split}\]</div>
<p>The sign difference between the exponent in the time-domain transform and the space-domain transform is chosen to be consistent with our convention on forward and backward traveling waves.</p>
</section>
<section id="Relative-Permittivity">
<h3>Relative Permittivity<a class="headerlink" href="#Relative-Permittivity" title="Permalink to this heading">#</a></h3>
<p>The relative permittivity <span class="math notranslate nohighlight">\(\epsilon\)</span> may be cast in terms of the angular frequency and wavenumber of the traveling wave. This quantity can further be broken apart into two real quantities representing the index of refraction <span class="math notranslate nohighlight">\(n\)</span> and the gain <span class="math notranslate nohighlight">\(\alpha\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\epsilon &amp;= \mathbb{1} + \chi^{(1)}
\\
&amp;= \left(\frac{c}{\omega} k \right)^{2}
\\
&amp;= \left(\frac{c}{\omega} \left(\beta + i \frac{\alpha}{2}\right) \right)^{2}
\\
&amp;= \left(n + i \frac{c}{\omega} \frac{\alpha}{2} \right)^{2}
\end{align}\end{split}\]</div>
<p>with the wavenumber <span class="math notranslate nohighlight">\(k\)</span> and phase coefficient <span class="math notranslate nohighlight">\(\beta\)</span> defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
k\ &amp;= \beta + i \frac{\alpha}{2}
\\
\beta &amp;= \frac{\omega}{c} n
\end{align}\end{split}\]</div>
<section id="Gain-and-Loss">
<h4>Gain and Loss<a class="headerlink" href="#Gain-and-Loss" title="Permalink to this heading">#</a></h4>
<p>Power rises or falls off at the exponential of the gain coefficient <span class="math notranslate nohighlight">\(\left(\exp\!{\left(\alpha \, z\right)}\right)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\text{Gain} &amp;: \alpha &gt; 0
\\
\text{Loss} &amp;: \alpha &lt; 0
\end{align}\end{split}\]</div>
</section>
<section id="Dispersion">
<h4>Dispersion<a class="headerlink" href="#Dispersion" title="Permalink to this heading">#</a></h4>
<p>The change of <span class="math notranslate nohighlight">\(\beta\)</span> with respect to frequency determines the group velocity of a traveling wave and the rate at which frequency components spread apart during propagation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\beta_{n} &amp;= \frac{\partial^{n} \beta}{\partial \omega^{n}}
\\
\frac{1}{v_{g}} = \frac{n_{g}}{c} = \beta_{1} &amp;= \frac{1}{c} \left(n + \nu \frac{\partial n}{\partial \nu} \right)
\\
-\frac{\lambda^{2}}{2 \pi c} D = \beta_{2} &amp;= \frac{1}{2 \pi c} \left( 2 \frac{\partial n}{\partial \nu} + \nu \frac{\partial^{2} n}{\partial \nu^{2}} \right)
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(v_{g}\)</span> and <span class="math notranslate nohighlight">\(n_{g}\)</span> are the group velocity and group index, and <span class="math notranslate nohighlight">\(\beta_{2}\)</span> and <span class="math notranslate nohighlight">\(D\)</span> are the group velocity dispersion (GVD) and dispersion parameter. The dispersion is separated into two categories depending on sign:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\text{Normal} &amp;: \beta_2 \gt 0, \ D \lt 0
\\
\text{Anomalous} &amp;: \beta_2 \lt 0, \ D \gt 0
\end{align}\end{split}\]</div>
<p>In most cases, materials have normal dispersion and high frequency components propagate slower than low frequency components. Respectively, <span class="math notranslate nohighlight">\(\beta_{2}\)</span> and <span class="math notranslate nohighlight">\(D\)</span> are typically given in units of <span class="math notranslate nohighlight">\(\text{fs}^2/\text{mm}\)</span> and <span class="math notranslate nohighlight">\(\text{ps}/(\text{nm km})\)</span>.</p>
</section>
</section>
</section>
<section id="Waveguides">
<h2>Waveguides<a class="headerlink" href="#Waveguides" title="Permalink to this heading">#</a></h2>
<p>An interesting class of devices takes advantage of materials in which the refractive index is greater in some cross-sectional area than in any other. Such a configuration guides optical radiation along a set of spatial modes. <a class="reference external" href="https://doi.org/10.1007/978-1-4613-2813-1">Optical Waveguide Theory (1983)</a> by Snyder and Love is an invaluable reference on this topic and the reader is encouraged to browse this resource for a more in-depth discussion of orthogonality, waveguide modes, and propagation
equations.</p>
<section id="Eigenmodes-Equations">
<h3>Eigenmodes Equations<a class="headerlink" href="#Eigenmodes-Equations" title="Permalink to this heading">#</a></h3>
<p>Waveguide modes may be derived assuming that the optical medium is <em>source free</em>, that there is <em>no nonlinearity</em>, and that the <em>relative electric permittivity is longitudinally invariant, separable into transverse and longitudinal components, and is lossless</em>. With these conditions the wave equations in the time-space domain <span class="math notranslate nohighlight">\(\left(t, \mathbf{x}\right)\)</span> represent eigenvalue equations for the electric and magnetic fields:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\text{Source Free} &amp;: \rho_f=0, \quad \mathbf{J}_f=0
\\
\text{Ignore Nonlinearity} &amp;: \mathbf{P}_{NL}=0
\\
\text{Longitudinally Invariant} &amp;: \frac{\partial}{\partial z} \epsilon = 0
\\
\text{Transverse Separable} &amp;: \epsilon = \epsilon_t + \epsilon_z
\\
\text{Lossless} &amp;: \epsilon = \epsilon^{*T} = \epsilon^\dagger
\end{align}\end{split}\]</div>
<p>These eigenvalue equations are derived by breaking apart Maxwell’s equations into transverse and longitudinal components (see the <a class="reference internal" href="supplemental.html#Transverse-and-Longitudinal-Maxwell's-Equations"><span class="std std-ref">supplemental</span></a> for more details).</p>
<section id="Transverse-Wave-Equations">
<h4>Transverse Wave Equations<a class="headerlink" href="#Transverse-Wave-Equations" title="Permalink to this heading">#</a></h4>
<p>In the <span class="math notranslate nohighlight">\(\left(\omega, \left[\mathbf{x}_t, k_z\right]\right)\)</span> mixed Fourier domain:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
&amp; \begin{split}
    \mathbf{0} &amp;= k_z^2 \ \mathbf{E}_t - \nabla^2_t \mathbf{E}_t  - \frac{\omega^2}{c^2} \left(\epsilon_t \cdot \mathbf{E}_t\right)
    \\
    &amp; + \nabla_t \left(\nabla_t \cdot \left(\left(\mathbf{1} - \epsilon_{zz}^{-1} \, \epsilon_t \right) \cdot \mathbf{E}_t \right)\right) + \nabla_t \left(\left( \nabla_t \epsilon_{zz}^{-1} \right) \cdot \left(\epsilon_t \cdot \mathbf{E}_t\right)\right) \end{split}
\\ \\
&amp; \begin{split}
    \mathbf{0} &amp;= k_z^2 \, \mathbf{H}_t - \epsilon_{zz}^{-1} \, \mathbf{\tilde{\epsilon}}_t \cdot \left(\nabla_t^2 \mathbf{H}_t\right)  - \frac{\omega^2}{c^2} \left(\mathbf{\tilde{\epsilon}}_t \cdot \mathbf{H}_t\right)
    \\
    &amp; - \left(\mathbf{1} - \epsilon_{zz}^{-1} \, \mathbf{\tilde{\epsilon}}_t\right) \cdot \nabla_t \left(\nabla_t \cdot \mathbf{H}_t\right) + \mathbf{\tilde{\epsilon}}_t \cdot \left(\left(\nabla_t \epsilon_{zz}^{-1}\right) \times \left(\nabla_t \times \mathbf{H}_t\right)\right)
\end{split}
\end{align}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(\epsilon\)</span> and <span class="math notranslate nohighlight">\(\mathbf{\tilde{\epsilon}}\)</span> defined as,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\epsilon &amp;= \left(
    \begin{array}{ccc}
    \epsilon_{xx} &amp; \epsilon_{xy} &amp; 0 \\
    \epsilon_{yx} &amp; \epsilon_{yy} &amp; 0 \\
    0 &amp; 0 &amp; \epsilon_{zz}
    \end{array}\right)
\\
\mathbf{\tilde{\epsilon}} &amp;= \left(
    \begin{array}{ccc}
    \epsilon_{yy} &amp; -\epsilon_{yx} &amp; 0 \\
    -\epsilon_{xy} &amp; \epsilon_{xx} &amp; 0 \\
    0 &amp; 0 &amp; \epsilon_{zz}
    \end{array}\right)
\end{align}\end{split}\]</div>
<p>The basic form and properties of these equations can be more easily seen by restricting the physical parameter space. If <span class="math notranslate nohighlight">\(\nabla \epsilon = 0\)</span> except at discrete boundaries:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{0} &amp;= k_z^2 \, \mathbf{E}_t - \nabla^2_t \mathbf{E}_t - \frac{\omega^2}{c^2} \, \epsilon \, \mathbf{E}_t
\\
\mathbf{0} &amp;= k_z^2 \, \mathbf{H}_t - \nabla^2_t \mathbf{H}_t - \frac{\omega^2}{c^2} \, \epsilon \, \mathbf{H}_t
\end{align}\end{split}\]</div>
<p>Thus, the transverse wave equations are <em>eigenvalue equations</em> for the transverse space-domain fields <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{H}\)</span>. For every frequency <span class="math notranslate nohighlight">\(\omega\)</span> there is a set of <span class="math notranslate nohighlight">\(\mathbf{E}_n\)</span> and <span class="math notranslate nohighlight">\(\mathbf{H}_n\)</span> that satisfy the wave equations for discrete <span class="math notranslate nohighlight">\(k_z = \beta_n\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is a unique mode identifier. These modes are typically found numerically. See <a class="reference external" href="https://doi.org/10.1109/JLT.2008.923643">Fallahkhair (2008)</a> for an example of a mode
solver that implements the transverse wave equations using finite difference techniques.</p>
</section>
<section id="Longitudinal-Modes">
<h4>Longitudinal Modes<a class="headerlink" href="#Longitudinal-Modes" title="Permalink to this heading">#</a></h4>
<p>By inspection of Maxwell’s equations in the <span class="math notranslate nohighlight">\(\left(\omega, \left[\mathbf{x}_t, k_z\right]\right)\)</span> mixed Fourier domain, the modal solutions of the electric and magnetic field must take the following form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{E} &amp;\to \delta\!\left[k_z - \beta_n\!\left[\omega\right] \right] \, \mathbf{E}_n
\\
\mathbf{H} &amp;\to \delta\!\left[k_z - \beta_n\!\left[\omega\right] \right] \, \mathbf{H}_n
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta\!\left[...\right]\)</span> is Dirac’s delta function.</p>
<p>Using this relationship, it is possible to show that in the mixed frequency-space domain <span class="math notranslate nohighlight">\(\left(\omega, \mathbf{x}\right)\)</span> the electric and magnetic fields are also eigenmodes of the spatial derivative along the propagation axis <span class="math notranslate nohighlight">\(z\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\frac{\partial}{\partial z} \mathbf{E}_n\!\left[\omega, z\right] &amp;= \frac{\partial}{\partial z} \int_{-\infty}^{\infty} \delta\!\left[k_z - \beta_n\right] \mathbf{E}_n\!\left[\omega, k_z\right] e^{-i \left(k_z \ z\right)} \frac{dk_z}{2 \pi}
\\
&amp;= \int_{-\infty}^{\infty} \left(-i \ k_z\right)\delta\!\left[k_z - \beta_n\right] \mathbf{E}_n\!\left[\omega, k_z\right] e^{-i \left(k_z \ z\right)} \frac{dk_z}{2 \pi}
\\
&amp;= -i \ \beta_n \ \mathbf{E}_n\!\left[\omega, z\right]
\\
\frac{\partial}{\partial z} \mathbf{H}_n\!\left[\omega, z\right] &amp;= -i \ \beta_n \ \mathbf{H}_n\!\left[\omega, z\right]
\end{align}\end{split}\]</div>
</section>
</section>
<section id="Forward-and-Backward-Modes">
<h3>Forward and Backward Modes<a class="headerlink" href="#Forward-and-Backward-Modes" title="Permalink to this heading">#</a></h3>
<p>Forward travelling and backward travelling modes both satisfy Maxwell’s equations. Given the relationship between transverse and longitudinal components there must be a fixed sign difference between the complementary modes. Of the two possible transformations between the forward and backward fields, the following convention will be used throughout the rest of this document.</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
\beta_- = -\beta_+
\end{gather}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathbf{E}^-_t &amp;= +\mathbf{E}^+_t &amp; E^-_z &amp;= -E^+_z
\\
\mathbf{H}^-_t &amp;= -\mathbf{H}^+_t &amp; H^-_z &amp;= +H^+_z
\end{align}\end{split}\]</div>
</section>
<section id="Reciprocity-Theorem">
<h3>Reciprocity Theorem<a class="headerlink" href="#Reciprocity-Theorem" title="Permalink to this heading">#</a></h3>
<p>The reciprocity theorem is derived from the two-dimensional form of the divergence theorem:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
\int_A \nabla \cdot \mathbf{F} \ dA = \frac{\partial}{\partial z} \int_A \mathbf{F} \cdot \hat{\mathbf{z}} \, dA + \oint_l \mathbf{F} \cdot \hat{\mathbf{n}} \, dl
\end{gather}\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is an arbitrary cross-sectional area of a waveguide, and <span class="math notranslate nohighlight">\(\hat{\mathbf{z}}\)</span> is the unit vector parallel to the propagation axis. The line integral is along the boundary of <span class="math notranslate nohighlight">\(A\)</span>, and <span class="math notranslate nohighlight">\(\hat{\mathbf{n}}\)</span> is the outward pointing unit vector normal to the boundary <span class="math notranslate nohighlight">\(l\)</span> in the plane of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>For optical waveguides, <span class="math notranslate nohighlight">\(A\)</span> is taken to be the infinite cross-section <span class="math notranslate nohighlight">\(A_\infty\)</span>. The line integral is then over the circle <span class="math notranslate nohighlight">\(r = \infty\)</span>, where <span class="math notranslate nohighlight">\(r\)</span> is the cylindrical radius. If the fields correspond to bound modes, then <span class="math notranslate nohighlight">\(\mathbf{F}\)</span> vanishes as <span class="math notranslate nohighlight">\(r \to \infty\)</span> (see <a class="reference external" href="https://doi.org/10.1007/978-1-4613-2813-1">Snyder and Love</a>). The reciprocity theorem is obtained by expanding the integrals across the entire transverse plane and then dropping the line
integral:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
\int_{A_\infty} \nabla \cdot \mathbf{F} \, dA = \frac{\partial}{\partial z} \int_{A_\infty} \mathbf{F} \cdot \hat{\mathbf{z}} \, dA
\end{gather}\]</div>
</section>
<section id="Orthogonality">
<h3>Orthogonality<a class="headerlink" href="#Orthogonality" title="Permalink to this heading">#</a></h3>
<p>Optical modes are orthogonal to each other. This relationship is derived by applying the reciprocity theorem to Poynting-vector-like combinations of waveguide modes. We start by defining a composite vector function <span class="math notranslate nohighlight">\(\mathbf{F}_c\)</span> in the frequency-space <span class="math notranslate nohighlight">\(\left(\omega, \mathbf{x}\right)\)</span> domain containing two arbitrary modes of the waveguide (<span class="math notranslate nohighlight">\(\mathbf{E}_r\)</span>, <span class="math notranslate nohighlight">\(\mathbf{H}_r\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{E}_s\)</span>, <span class="math notranslate nohighlight">\(\mathbf{H}_s\)</span>):</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_c = \mathbf{E}_r \times \mathbf{H}_s^* + \mathbf{E}_s^* \times \mathbf{H}_r\]</div>
<p>The divergence of this function is <span class="math notranslate nohighlight">\(0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\nabla \cdot \mathbf{F}_c &amp;= \mathbf{H}_s^* \cdot \left(\nabla \times \mathbf{E}_r\right) - \mathbf{E}_r \cdot \left(\nabla \times \mathbf{H}_s\right)^* + \mathbf{H}_r \cdot \left(\nabla \times \mathbf{E}_s\right)^* - \mathbf{E}_s^* \cdot \left(\nabla \times \mathbf{H}_r\right)
\\
&amp;= \mathbf{H}_s^* \cdot \left(- i \, \omega \, \mu_0 \, \mathbf{H}_r\right) - \mathbf{E}_r \cdot \left(-i \, \omega \, \epsilon_0 \, \mathbf{\epsilon}^* \cdot \mathbf{E}_s^*\right) + \mathbf{H}_r \cdot \left(i \, \omega \, \mu_0 \, \mathbf{H}_s^*\right) - \mathbf{E}_s^* \cdot \left(i \, \omega \, \epsilon_0 \, \mathbf{\epsilon} \cdot \mathbf{E}_r\right)
\\
&amp;= i \, \omega \, \epsilon_0 \left(\mathbf{E}_r \cdot \mathbf{\epsilon}^* \cdot \mathbf{E}_s^* - \mathbf{E}_s^* \cdot \mathbf{\epsilon} \cdot \mathbf{E}_r\right)
\\
&amp;= i \, \omega \, \epsilon_0 \left(\mathbf{E}_r \cdot \left(\mathbf{\epsilon}^* - \mathbf{\epsilon}^T\right) \cdot \mathbf{E}_s^*\right)
\\
&amp;= 0
\end{align}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\epsilon}^\ast = \mathbf{\epsilon}^T\)</span>, or equivalently <span class="math notranslate nohighlight">\(\mathbf{\epsilon}^\dagger = \mathbf{\epsilon}\)</span>, which assumes that the waveguide is lossless.</p>
<p>Next, consider two forward propagating modes <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(s\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
0 &amp;= \frac{\partial}{\partial z} \int_{A_\infty} \mathbf{F}_c \cdot \hat{\mathbf{z}} \ dA \\
&amp;= \left(-i \ \beta_r + i \ \beta_s\right) \int_{A_\infty} \left(\mathbf{E}_r \times \mathbf{H}_s^\ast + \mathbf{E}_s^\ast \times \mathbf{H}_r\right) \cdot \hat{\mathbf{z}} \ dA \\
\end{align}\end{split}\]</div>
<p>Finally, consider the same forward propagating mode <span class="math notranslate nohighlight">\(r\)</span>, but backward propagating mode <span class="math notranslate nohighlight">\(s\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
0 &amp;= \frac{\partial}{\partial z} \int_{A_\infty} \mathbf{F}_c \cdot \hat{\mathbf{z}} \, dA
\\
&amp;= \left(-i \, \beta_r + i \, \beta_{-s}\right) \int_{A_\infty} \left(\mathbf{E}_r \times \mathbf{H}_{-s}^\ast + \mathbf{E}_{-s}^\ast \times \mathbf{H}_r\right) \cdot \hat{\mathbf{z}} \, dA
\\
&amp;= \left(-i \, \beta_r - i \, \beta_s\right) \int_{A_\infty} \left(-\mathbf{E}_r \times \mathbf{H}_{s}^\ast + \mathbf{E}_{s}^\ast \times \mathbf{H}_r\right) \cdot \hat{\mathbf{z}} \, dA
\end{align}\end{split}\]</div>
<p>Dividing out the phase coefficients and then adding or subtracting the two relations gives the orthogonality condition:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather}
\text{if $r \ne s$}
\\
0 = \int_{A_\infty} \left(\mathbf{E}_r \times \mathbf{H}_{s}^\ast\right) \cdot \hat{\mathbf{z}} \, dA = \int_{A_\infty} \left(\mathbf{E}_s^\ast \times \mathbf{H}_{r}\right) \cdot \hat{\mathbf{z}} \, dA
\end{gather}\end{split}\]</div>
</section>
<section id="Orthonormal-Modes">
<h3>Orthonormal Modes<a class="headerlink" href="#Orthonormal-Modes" title="Permalink to this heading">#</a></h3>
<p>Orthogonal sets can reconstruct arbitrary distributions through linear combination. For electromagnetic fields these sets are best given as the product of amplitudes and orthonormal spatial modes. In the frequency-space <span class="math notranslate nohighlight">\(\left(\omega, \mathbf{x}\right)\)</span> domain:</p>
<div class="math notranslate nohighlight">
\[\begin{align}
\mathbf{E} &amp;= \sum_n a_n \, e^{-i \, \beta_n \, z} \, \hat{\mathbf{e}}_n
&amp;
\mathbf{H} &amp;= \sum_n a_n \, e^{-i \, \beta_n \, z} \, \hat{\mathbf{h}}_n
\end{align}\]</div>
<p>The orthogonality relationship applied between the same two modes directly yields the Poynting vector of the electromagnetic field. We use this information to set the normalization and units:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
I_n = \mathbf{S}_n \cdot \hat{\mathbf{z}} &amp;= \left(\mathbf{E}_n \times \mathbf{H}_n^*\right) \cdot \hat{\mathbf{z}}
\\
&amp;= \left|a_n\right|^2 \left(\hat{\mathbf{e}}_n \times \hat{\mathbf{h}}_n^*\right) \cdot \hat{\mathbf{z}}
\end{align}\end{split}\]</div>
<section id="Normalization">
<h4>Normalization<a class="headerlink" href="#Normalization" title="Permalink to this heading">#</a></h4>
<p>The modes <span class="math notranslate nohighlight">\(\hat{e}_n\)</span> and <span class="math notranslate nohighlight">\(\hat{h}_n\)</span> are normalized so that the integral over the transverse plane is equal to 1:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
\int_{A_\infty} \left|\left(\hat{\mathbf{e}}_n \times \hat{\mathbf{h}}_n^*\right) \cdot \hat{\mathbf{z}}\right| dA = 1
\end{gather}\]</div>
<p>The total energy is the integral of <span class="math notranslate nohighlight">\(\left|a_n\right|^2\)</span> over all frequencies and over all time:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
E_n = \int_{-\infty}^{+\infty} \left|a_n\right|^2 d\nu = \int_{-\infty}^{+\infty} \left|a_n\right|^2 dt
\end{gather}\]</div>
<p>Replacing <span class="math notranslate nohighlight">\(\hat{\mathbf{h}}\)</span> with the <a class="reference internal" href="supplemental.html#Transverse-Curl-Equations"><span class="std std-ref">transverse curl relationship</span></a> yields the normalization in terms of the electric field only:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat{\mathbf{h}}_t &amp;= \hat{\mathbf{z}} \times \left(\epsilon_0 \, c \, n_\text{eff} \left(\hat{\mathbf{e}}_t - \frac{i}{\beta} \nabla_t \hat{e}_z\right)\right)
\\
\left(\hat{\mathbf{e}} \times \hat{\mathbf{h}}^*\right) \cdot \hat{\mathbf{z}} &amp;= \epsilon_0 \, c \, n_\text{eff} \left(\left|\hat{\mathbf{e}}_t\right|^2 + \frac{i}{\beta} \hat{\mathbf{e}}_t \cdot \nabla_t \hat{e}_z^* \right)
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{gather}
\int_{A_\infty} \left(\left|\hat{\mathbf{e}}_t\right|^2 + \frac{i}{\beta} \hat{\mathbf{e}}_t \cdot \nabla_t \hat{e}_z^* \right) dA = \frac{1}{\epsilon_0 \, c \, n_\text{eff}}
\end{gather}\]</div>
<p>where the mode identifiers for <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}\)</span> and <span class="math notranslate nohighlight">\(\hat{\mathbf{h}}\)</span> are implicit. The effective refractive index <span class="math notranslate nohighlight">\(n_\text{eff}\)</span> is defined through the mode’s <span class="math notranslate nohighlight">\(\beta\)</span> eigenvalue.</p>
<p>From the divergence relations, the second term in the above equation scales with one over <span class="math notranslate nohighlight">\(\beta^2\)</span> times the second derivative of <span class="math notranslate nohighlight">\(\hat{\mathbf{e}}_t\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{gather}
\frac{i}{\beta} \nabla_t \hat{e}_z^* \sim \frac{1}{\beta^2} \nabla_t \left(\nabla_t \cdot \hat{\mathbf{e}}_t^*\right)
\end{gather}\]</div>
<p>Thus, smaller <span class="math notranslate nohighlight">\(\beta\)</span> (lower frequencies) and smaller waveguide cross sections or higher order modes (larger spatial derivatives) increase the importance of this term. The first and second term become comparable when the transverse spatial derivative is of the same order of magnitude as the phase coefficient <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
</section>
<section id="Units">
<h4>Units<a class="headerlink" href="#Units" title="Permalink to this heading">#</a></h4>
<p>The above normalization relations fix the units of their respective quantities:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\left(\hat{\mathbf{e}}_n \times \hat{\mathbf{h}}_n^*\right) &amp;\sim \frac{1}{\text{area}}
\\ \\
\bigl|a_n\bigr|^2 &amp;\sim \text{energy density}
\end{align}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\Bigl|a_n\!\left[\nu\right]\Bigr|^2 &amp;\sim \frac{\text{energy}}{\text{frequency}} = \text{action}
&amp;
\Bigl|a_n\!\left[t\right]\Bigr|^2 &amp;\sim \frac{\text{energy}}{\text{time}} = \text{power}
\end{align}\]</div>
<div class="math notranslate nohighlight">
\[\begin{align}
\hat{e}^2 &amp;\sim \frac{1}{\left(\epsilon_0 \ c\right) \text{area}}
&amp;
\hat{h}^2 &amp;\sim \frac{1}{\left(\mu_0 \ c\right) \text{area}}
\end{align}\]</div>
</section>
<section id="Effective-Area">
<h4>Effective Area<a class="headerlink" href="#Effective-Area" title="Permalink to this heading">#</a></h4>
<p>The effective or equivalent area provides a reasonable measure of a mode’s spatial extent. It is a derived quantity and is defined as the ratio of the squared integral of the transverse intensity to the integral of the squared transverse intensity:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
A_\text{eff} = \frac{\left(\int_{A_\infty} \mathbf{S}_n \cdot \hat{\mathbf{z}} \ dA\right)^2}{\int_{A_\infty} \left(\mathbf{S}_n \cdot \hat{\mathbf{z}}\right)^2 dA} &amp;= \left(\int_{A_\infty} \left(\left(\hat{\mathbf{e}}_n \times \hat{\mathbf{h}}_n^*\right) \cdot \hat{\mathbf{z}}\right)^2 dA\right)^{-1}
\\
&amp;= \frac{1}{\left(\epsilon_0 \ c \ n_\text{eff}\right)^2} \left(\int_{A_\infty} \left(\left|\hat{\mathbf{e}}_t\right|^2 + \frac{i}{\beta} \hat{\mathbf{e}}_t \cdot \nabla_t \hat{e}_z^* \right)^2 dA\right)^{-1}
\end{align}\end{split}\]</div>
<p>This definition has two illuminating cases. In the limit of a constant mode profile, the effective area is the area over which the mode is supported. For a Gaussian profile with <span class="math notranslate nohighlight">\(1/e^2\)</span> radius of <span class="math notranslate nohighlight">\(r\)</span>, this formula gives an effective area of <span class="math notranslate nohighlight">\(\pi \, r^2\)</span>, the area within the <span class="math notranslate nohighlight">\(1/e^2\)</span> radius.</p>
</section>
</section>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="fourier_transforms.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Fourier Transforms</p>
      </div>
    </a>
    <a class="right-next"
       href="nonlinear_optics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Nonlinear Optics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Maxwell's-Equations">Maxwell’s Equations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Electric-and-Magnetic-Polarization">Electric and Magnetic Polarization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Boundary-Conditions">Boundary Conditions</a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Normal-Components">Normal Components</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Tangential-Components">Tangential Components</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Traveling-Waves">Traveling Waves</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#A-Note-on-Fourier-Transforms-and-Units">A Note on Fourier Transforms and Units</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Relative-Permittivity">Relative Permittivity</a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Gain-and-Loss">Gain and Loss</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Dispersion">Dispersion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Waveguides">Waveguides</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Eigenmodes-Equations">Eigenmodes Equations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Transverse-Wave-Equations">Transverse Wave Equations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Longitudinal-Modes">Longitudinal Modes</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Forward-and-Backward-Modes">Forward and Backward Modes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Reciprocity-Theorem">Reciprocity Theorem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Orthogonality">Orthogonality</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Orthonormal-Modes">Orthonormal Modes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Normalization">Normalization</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Units">Units</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#Effective-Area">Effective Area</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, PyNLO authors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>